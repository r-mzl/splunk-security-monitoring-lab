<dashboard version="1.1" theme="dark" refresh="60">
  <label>SSH Security Monitoring</label>
  <row>
    <panel>
      <title>Failed SSH Logins</title>
      <chart>
        <title>Timechart</title>
        <search>
          <query>index=* "Failed password"
| timechart count by host</query>
          <earliest>@w0</earliest>
          <latest>now</latest>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
      </chart>
    </panel>
    <panel>
      <title>Bruteforce IPs</title>
      <table>
        <title>Top Bruteforce IPs</title>
        <search>
          <query>index=* "Failed password"
| rex "from (?&lt;src_ip&gt;\d+\.\d+\.\d+\.\d+)"
| stats count by src_ip
| where count &gt; 5
| sort - count</query>
          <earliest>@w0</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>
</dashboard>